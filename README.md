# router-module
GCP Terraform router module Repo

Google Cloud Platform(GCP)ì—ì„œ ë¼ìš°í„°ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ê¸° ìœ„í•œ Terraform ëª¨ë“ˆì…ë‹ˆë‹¤.  <br>
ì´ ëª¨ë“ˆì€ VPC ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°ëœ ë¼ìš°í„°ë¥¼ ì‰½ê²Œ êµ¬ì„±í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

<br>

## ğŸ“‘ **ëª©ì°¨**
1. [ëª¨ë“ˆ íŠ¹ì§•](#ëª¨ë“ˆ-íŠ¹ì§•)
2. [ì‚¬ìš© ë°©ë²•](#ì‚¬ìš©-ë°©ë²•)
    1. [ì‚¬ì „ ì¤€ë¹„](#1-ì‚¬ì „-ì¤€ë¹„)
    2. [ì…ë ¥ ë³€ìˆ˜](#2-ì…ë ¥-ë³€ìˆ˜)
    3. [ëª¨ë“ˆ í˜¸ì¶œ ì˜ˆì‹œ](#3-ëª¨ë“ˆ-í˜¸ì¶œ-ì˜ˆì‹œ)
    4. [ì¶œë ¥ê°’ (Outputs)](#4-ì¶œë ¥ê°’-outputs)
    5. [ì§€ì› ë²„ì „](#5-ì§€ì›-ë²„ì „)
    6. [ëª¨ë“ˆ ê°œë°œ ë° ê´€ë¦¬](#6-ëª¨ë“ˆ-ê°œë°œ-ë°-ê´€ë¦¬)
3. [í…ŒìŠ¤íŠ¸](#terratestë¥¼-ì´ìš©í•œ-í…ŒìŠ¤íŠ¸)
4. [ì£¼ìš” ë²„ì „ ê´€ë¦¬](#ì£¼ìš”-ë²„ì „-ê´€ë¦¬)
5. [ê¸°ì—¬](#ê¸°ì—¬-contributing)
6. [ë¼ì´ì„ ìŠ¤](#ë¼ì´ì„ ìŠ¤-license)

---

## ëª¨ë“ˆ íŠ¹ì§•

- Google Compute Routerë¥¼ ê°„ë‹¨í•˜ê²Œ ìƒì„±.
- VPC ë„¤íŠ¸ì›Œí¬ì™€ ì—°ë™í•˜ì—¬ ë¼ìš°íŒ… ì„¤ì • ì§€ì›.
- íŠ¹ì • ì§€ì—­ì— ë¼ìš°í„° ë°°ì¹˜ ê°€ëŠ¥.
- BGP ì„¤ì • ë° ë™ì  IP ê´‘ê³  ì§€ì›.
- Terraform ì¶œë ¥ê°’ìœ¼ë¡œ ìƒì„±ëœ ë¼ìš°í„° ì •ë³´ ì œê³µ

---

## ì‚¬ìš© ë°©ë²•

### 1. ì‚¬ì „ ì¤€ë¹„

ë‹¤ìŒ ì‚¬í•­ì„ í™•ì¸í•˜ì„¸ìš”:
1. Google Cloud í”„ë¡œì íŠ¸ ì¤€ë¹„.
2. ì ì ˆí•œ IAM ê¶Œí•œ í•„ìš”: `roles/compute.networkAdmin` (ë¼ìš°í„° ê´€ë¦¬ ê¶Œí•œ í•„ìˆ˜).
3. VPC ë„¤íŠ¸ì›Œí¬ë¥¼ ë™ì‹œì— ìƒì„±í•˜ê±°ë‚˜, ì´ë¯¸ ìƒì„±í•´ë†“ì•„ì•¼ í•¨.

<br>

### 2. ì…ë ¥ ë³€ìˆ˜

| ë³€ìˆ˜ëª…                       | íƒ€ì…           | í•„ìˆ˜ ì—¬ë¶€ | ê¸°ë³¸ê°’ | ì„¤ëª…                                  |
|------------------------------|----------------|-----------|--------|---------------------------------------|
| `name`                       | string         | âœ…        | ì—†ìŒ   | ìƒì„±í•  ë¼ìš°í„°ì˜ ì´ë¦„                  |
| `network`                    | string         | âœ…        | ì—†ìŒ   | ì—°ê²°í•  VPC ë„¤íŠ¸ì›Œí¬ì˜ ID               |
| `description`                | string         | âŒ        | null   | ë¼ìš°í„° ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì„¤ëª…              |
| `encrypted_interconnect_router` | bool          | âŒ        | null   | ì•”í˜¸í™”ëœ VLAN ì²¨ë¶€ìš© ë¼ìš°í„° ì—¬ë¶€        |
| `region`                     | string         | âœ…        | null   | ë¼ìš°í„°ê°€ ë°°ì¹˜ë  ì§€ì—­ (ì˜ˆ: `asia-northeast3`) |
| `project`                    | string         | âŒ        | null   | ë¼ìš°í„°ê°€ ì†í•œ GCP í”„ë¡œì íŠ¸ ID (ì œê³µë˜ì§€ ì•Šìœ¼ë©´ Provider í”„ë¡œì íŠ¸ ì‚¬ìš©)  |
| `bgp`                        | object         | âŒ        | null   | BGP ì„¤ì • (ASN, ê´‘ê³  ëª¨ë“œ ë“± í¬í•¨). ì•„ë˜ í•˜ìœ„ í•„ë“œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”. |
| `timeout_create`             | string         | âŒ        | `"20m"`| ë¦¬ì†ŒìŠ¤ ìƒì„± ì œí•œ ì‹œê°„                  |
| `timeout_update`             | string         | âŒ        | `"20m"`| ë¦¬ì†ŒìŠ¤ ì—…ë°ì´íŠ¸ ì œí•œ ì‹œê°„              |
| `timeout_delete`             | string         | âŒ        | `"20m"`| ë¦¬ì†ŒìŠ¤ ì‚­ì œ ì œí•œ ì‹œê°„                  |

#### `bgp` ë³€ìˆ˜ í•˜ìœ„ í•„ë“œ
| í•„ë“œëª…                   | íƒ€ì…   | í•„ìˆ˜ ì—¬ë¶€ | ê¸°ë³¸ê°’          | ì„¤ëª…                                   |
|--------------------------|--------|-----------|-----------------|----------------------------------------|
| `asn`                    | number | âœ…        | ì—†ìŒ            | BGP ASN ë²ˆí˜¸                            |
| `advertise_mode`         | string | âŒ        | `"DEFAULT"`     | BGP ê´‘ê³  ëª¨ë“œ (`DEFAULT`, `CUSTOM`)       |
| `advertised_groups`      | list   | âŒ        | `[]`            | ê´‘ê³ í•  ê·¸ë£¹ ë¦¬ìŠ¤íŠ¸ (`ALL_SUBNETS` ë“±)       |
| `advertised_ip_ranges`   | list   | âŒ        | `[]`            | ê´‘ê³ í•  IP CIDR ë²”ìœ„                     |
| `keepalive_interval`     | number | âŒ        | 20              | BGP Keepalive Interval (ì´ˆ ë‹¨ìœ„)         |

<br>

### 3. ëª¨ë“ˆ í˜¸ì¶œ ì˜ˆì‹œ

```hcl
module "router" {
  source = "git::https://github.com/GCP-Terraform-Module-steamedEggMaster/router-module.git?ref=v1.0.0"

  name        = "custom-router"
  network     = "projects/my-project-id/global/networks/my-vpc"
  description = "Example Router"
  region      = "asia-northeast3"
  project     = "my-project-id"
  bgp = {
    asn               = 64512
    advertise_mode    = "CUSTOM"
    advertised_groups = ["ALL_SUBNETS"]
    advertised_ip_ranges = [
      { range = "192.168.1.0/24", description = "Example range" },
      { range = "192.168.2.0/24", description = "Another range" }
    ]
    keepalive_interval = 20
    identifier_range   = "10.1.0.0/16"
  }
}
```

<br>

### 4. ì¶œë ¥ê°’ (Outputs)

| ì¶œë ¥ëª…              | ì„¤ëª…                                    |
|---------------------|----------------------------------------|
| `name`             | ìƒì„±ëœ ë¼ìš°í„°ì˜ ì´ë¦„                        |
| `self_link`        | ìƒì„±ëœ ë¼ìš°í„°ì˜ URI                        |
| `id`               | ìƒì„±ëœ ë¼ìš°í„°ì˜ ê³ ìœ  ì‹ë³„ì                 |
| `region`           | ìƒì„±ëœ ë¼ìš°í„°ê°€ ìœ„ì¹˜í•œ GCP ë¦¬ì „              |
| `network`          | ìƒì„±ëœ ë¼ìš°í„°ê°€ ì†í•œ ë„¤íŠ¸ì›Œí¬                |
| `creation_timestamp` | ë¼ìš°í„° ë¦¬ì†ŒìŠ¤ ìƒì„± ì‹œê°„ (RFC3339 í˜•ì‹)       |
| `project`          | ë¼ìš°í„°ê°€ ì†í•œ GCP í”„ë¡œì íŠ¸ ID               |

<br>

### 5. ì§€ì› ë²„ì „

#### a.  Terraform ë²„ì „
| ë²„ì „ ë²”ìœ„ | ì„¤ëª…                              |
|-----------|-----------------------------------|
| `1.10.3`   | ìµœì‹  ë²„ì „, ì§€ì› ë° í…ŒìŠ¤íŠ¸ ì™„ë£Œ                  |

#### b. Google Provider ë²„ì „
| ë²„ì „ ë²”ìœ„ | ì„¤ëª…                              |
|-----------|-----------------------------------|
| `~> 4.0`  | ìµœì†Œ ì§€ì› ë²„ì „                   |

<br>

### 6. ëª¨ë“ˆ ê°œë°œ ë° ê´€ë¦¬

- **ì €ì¥ì†Œ êµ¬ì¡°**:
  ```
  router-module/
    â”œâ”€â”€ .github/workflows/  # github actions ìë™í™” í…ŒìŠ¤íŠ¸
    â”œâ”€â”€ examples/           # í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ë£¨íŠ¸ ëª¨ë“ˆ ëª¨ìŒ ë””ë ‰í„°ë¦¬
    â”œâ”€â”€ test/               # í…ŒìŠ¤íŠ¸ êµ¬ì„± ë””ë ‰í„°ë¦¬
    â”œâ”€â”€ main.tf             # ëª¨ë“ˆì˜ í•µì‹¬ êµ¬í˜„
    â”œâ”€â”€ variables.tf        # ì…ë ¥ ë³€ìˆ˜ ì •ì˜
    â”œâ”€â”€ outputs.tf          # ì¶œë ¥ ì •ì˜
    â”œâ”€â”€ README.md           # ë¬¸ì„œí™” íŒŒì¼
  ```

<br>

---

### Terratestë¥¼ ì´ìš©í•œ í…ŒìŠ¤íŠ¸
ì´ ëª¨ë“ˆì„ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ ì œê³µëœ Go ê¸°ë°˜ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. ì•„ë˜ë¥¼ í™•ì¸í•˜ì„¸ìš”:

1. Terraform ë° Go ì„¤ì¹˜.
2. í•„ìš”í•œ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •.
3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰:
```bash
go test -v ./test
```

<br>

## ì£¼ìš” ë²„ì „ ê´€ë¦¬
ì´ ëª¨ë“ˆì€ [Semantic Versioning](https://semver.org/)ì„ ë”°ë¦…ë‹ˆë‹¤.  
ì•ˆì •ëœ ë²„ì „ì„ ì‚¬ìš©í•˜ë ¤ë©´ `?ref=<version>`ì„ í™œìš©í•˜ì„¸ìš”:

```hcl
source = "git::https://github.com/GCP-Terraform-Module-steamedEggMaster/router-module.git?ref=v1.0.0"
```

### Module ref ë²„ì „
| Major | Minor | Patch |
|-----------|-----------|----------|
| `1.0.0`   |    |   |

<br>

## ê¸°ì—¬ (Contributing)
ê¸°ì—¬ë¥¼ í™˜ì˜í•©ë‹ˆë‹¤! ë²„ê·¸ ì œë³´ ë° ê¸°ëŠ¥ ìš”ì²­ì€ GitHub Issuesë¥¼ í†µí•´ ì œì¶œí•´ì£¼ì„¸ìš”.

<br>

## ë¼ì´ì„ ìŠ¤ (License)
[MIT License](LICENSE)